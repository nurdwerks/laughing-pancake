<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generation Details</title>
    <link rel="stylesheet" href="main_style.css">
</head>
<body>
    <div class="full-width-container">
        <h1 id="generation-title"></h1>
        <div id="generation-details">
            <!-- Generation data will be loaded here -->
        </div>
        <div class="link-container">
            <a href="history.html" class="button-link">View History</a>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const detailsContainer = document.getElementById('generation-details');
            const titleElement = document.getElementById('generation-title');
            const params = new URLSearchParams(window.location.search);
            const requestedGenId = params.get('gen');

            if (requestedGenId) {
                titleElement.textContent = `Generation ${requestedGenId}`;
                fetchGenerationData(requestedGenId, detailsContainer);
            } else {
                titleElement.textContent = 'No Generation Specified';
            }

            function fetchGenerationData(genId, contentElement) {
                fetch(`/api/generation/${genId}`)
                    .then(response => response.json())
                    .then(data => {
                        contentElement.innerHTML = ''; // Clear previous content
                        const header = document.createElement('div');
                        header.className = 'individual-header';
                        header.innerHTML = `
                            <div>ID</div>
                            <div>ELO</div>
                            <div>Configuration</div>
                        `;
                        contentElement.appendChild(header);

                        data.population.individuals.forEach(ind => {
                            const individualDiv = document.createElement('div');
                            individualDiv.className = 'individual-row';
                            individualDiv.innerHTML = `
                                <div><a href="individual.html?gen=${genId}&ind=${ind.id}">${ind.id}</a></div>
                                <div>${ind.elo.toFixed(2)}</div>
                                <div><pre>${JSON.stringify(ind.config, null, 2)}</pre></div>
                            `;
                            contentElement.appendChild(individualDiv);
                        });
                    })
                    .catch(error => {
                        contentElement.innerHTML = `<p>Error loading generation data: ${error}</p>`;
                    });
            }
        });
    </script>
</body>
</html>
